# Java REST API with Spring Boot, Spring Data JPA, PostgreSQL with Docker
This project demonstrates a simple **Java REST API** built with **Spring Boot**, **Spring Data JPA**, and **PostgreSQL**, running the database in **Docker**.

Based on the course:
> **Spring Boot Tutorial for Beginners | Full Course 2025** by **amigoscode**
---

### üß± Tech Stack
* Java 21
* Spring Boot
* Spring Data JPA (Hibernate)
* PostgreSQL
* Docker & Docker Compose

---

### üê≥ PostgreSQL in Docker

#### `docker-compose.yml`

```yaml
services:
  db:
    container_name: postgres-spring-boot
    image: postgres:18.1-alpine
    restart: unless-stopped
    environment:
      POSTGRES_USER: postgres   # database name will be the same as username
      POSTGRES_PASSWORD:
      PGDATA: /data/postgres
    volumes:
      - db:/data/postgres
    ports:
      - "5332:5432"
    networks:
      - db

networks:
  db:
    driver: bridge

volumes:
  db:
```
#### ‚ñ∂Ô∏è Run PostgreSQL
```bash
docker compose up -d
```
---

### üß≠ Navigating PostgreSQL Container
#### Enter the container

```bash
docker exec -it (container id) bash
```

#### Open PostgreSQL shell

```bash
psql -U (username = postgres)
```

#### Useful PostgreSQL commands

```sql
\l    \list          -- list databases
CREATE DATABASE spring;
\c spring   \connect    -- connect to database
\d              -- list tables
\d engineers    -- show table structure
```

#### Deleting DB
DELETE DATABASE name;
docker compose down -v
-v - removes data volumes, and your db

---

### üìä Fetching Data from PostgreSQL

```sql
SELECT * FROM engineers;
```

Example output:

```text
 id |  name
----+--------
  1 | Albert
  2 | Megan
```

---

### üì¶ Spring Data JPA Repository

#### JPQL Query with `JOIN FETCH`

```java
@Query("SELECT DISTINCT e FROM SoftwareEngineer e LEFT JOIN FETCH e.techStack")
List<SoftwareEngineer> findAllWithTechStack();
```

#### üß† JPQL Notes

* `FETCH` ‚Üí forces eager loading of related collections
* `LEFT JOIN` ‚Üí includes engineers without tech stack
* `DISTINCT` ‚Üí removes duplicate entity instances caused by joins

#### What this JPQL does

* Fetches **SoftwareEngineer entities**
* Loads `@ElementCollection techStack` eagerly
* Prevents duplicate entities using `DISTINCT`

#### üîÑ Equivalent SQL Generated by Hibernate

```sql
SELECT e.id, e.name, t.tech_stack
FROM software_engineer e
LEFT JOIN software_engineer_tech_stack t
ON e.id = t.software_engineer_id;
```

---

### üåê Spring MVC Annotations

#### `@RestController`

* Used for REST APIs
* Returns JSON / XML responses
* Combines `@Controller` + `@ResponseBody`

#### `@Controller`

* Used for MVC applications
* Returns HTML views (Thymeleaf, JSP, etc.)

---

### üß© JPA / Hibernate Best Practices

* JPA entities **must have a no-args constructor**

```java
@NoArgsConstructor
```

* Avoid implementing `equals()` and `hashCode()` **when using generated IDs**

  * Unless explicitly designed to ignore the ID
  * Incorrect implementations can break Hibernate behavior

---

### ‚úÖ Summary

* Docker simplifies PostgreSQL setup
* JPQL operates on **entities**, not tables
* `JOIN FETCH` is essential for loading `@ElementCollection`
* Never expose entities directly in APIs ‚Äî use DTOs

---
